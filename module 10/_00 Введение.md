

```python
from time import sleep

def parser(site_name):
    for page in range(1,4):
        sleep(1)
        print(site_name, page)


parser('product')
parser('price')
parser('action')
```


## Асинхронный вариант

```python
from time import *
from asyncio import *

t0 = time()

async def parser(site_name): # корутина
    for page in range(1, 4):
        await sleep (1)
        print(site_name, page)


parsers = [
    ensure_future(parser('product')),
    ensure_future(parser('price')),
    ensure_future(parser('action')),
]

event_loop = get_event_loop()
event_loop.run_until_complete(gather(*parsers))
event_loop.close()
print(time() - t0)
```


Результат выполнения
```
product 1
price 1
action 1
product 2
price 2
action 2
product 3
price 3
action 3
```

## Вызов функций по расписанию

```python
def loader(url):
    print(f'Load from {url}')


async def parser(site_name): # корутина
    for page in range(1, 4):
        await sleep (1)
        print(site_name, page)


parsers = [
    ensure_future(parser('product')),
    ensure_future(parser('price')),
    ensure_future(parser('action')),
]

event_loop = get_event_loop()

loader('url-1')
event_loop.run_until_complete(gather(*parsers))
loader('url-2')

event_loop.close()
```

Результат

```python
Load from url-1
product 1
price 1
action 1
product 2
price 2
action 2
product 3
price 3
action 3
Load from url-2
```

Регистрируем функию

```python
event_loop = get_event_loop()

event_loop.call_soon(loader, 'url-1')

event_loop.run_until_complete(gather(*parsers))

event_loop.call_soon(loader, 'url-2')

```

Результат

```
Load from url-1
product 1
price 1
action 1
product 2
price 2
action 2
product 3
price 3
action 3
```
нет второго вызова `Load from url-1` ?!
Потому что он должен выполнится когда await уйдет в режим ожидания. 

т.е после того как event_loop.run_until_complete(gather(*parsers)) уйдет в режим ожидания

Поменяем местами `print` и `await`

```
async def parser(site_name): # корутина
    for page in range(1, 4):
        print(site_name, page)
        await sleep (1)
```

Результат
```python
product 1
price 1
action 1
Load from url-1
product 2
...
```